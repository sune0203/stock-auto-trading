# SOAR Trading System v2.1.0

나스닥 급등주 **완전 자동화** 실전 트레이딩 시스템

## 🔥 v2.1.0 주요 업데이트 (데이터 영구 보존)

### 📌 핵심 개선사항
- **데이터 영구 보존**: localStorage 활용으로 새로고침/재접속 시에도 데이터 유지
- **증분 업데이트**: 각 종목 분석 완료 시마다 즉시 화면에 표시 (스캔 완료 대기 불필요)
- **기존 데이터 유지**: 새 스캔 시작해도 기존 데이터는 유지하며 업데이트만 수행
- **데이터 초기화 버튼**: 사용자가 원할 때 수동으로 데이터 초기화 가능

### 자동 스캔 & 실시간 갱신
- **1분마다 자동 스캔**: 서버 시작 시 자동으로 NASDAQ 급등주 스캔 실행
- **실시간 데이터 스트림**: SSE(Server-Sent Events)를 통한 자동 업데이트
- **가격 기반 재평가**: 10초마다 현재가 기준으로 트레이딩 계획 재계산
- **완전 동적 대시보드**: 새로고침 없이 실시간 데이터 자동 표시

### 사용자 경험 개선
- ✅ 서버 실행 → 웹 접속만으로 자동 모니터링 시작
- ✅ **새로고침해도 데이터 유지** (localStorage + 서버 캐시)
- ✅ **각 종목 완료 시마다 즉시 표시** (스캔 완료 대기 불필요)
- ✅ **기존 데이터 유지하며 업데이트** (데이터가 사라지지 않음)
- ✅ 수동 스캔 버튼으로 즉시 추가 스캔 가능
- ✅ 실시간 가격 및 트레이딩 신호 자동 업데이트

---

## 🚀 빠른 시작

### 1. 환경 설정
```bash
# 의존성 설치
pip install -r requirements.txt

# .env 파일 생성 (env_template.txt 참고)
cp env_template.txt .env
# FMP_API_KEY, KIS_APP_KEY, DB 정보 입력
```

### 2. 서버 실행
```bash
cd backend
python server.py
```

### 3. 웹 접속
```
프론트엔드: http://localhost:4001
백엔드 API: http://localhost:8000
```

---

## 🎯 핵심 기능 (v1.3.0)

### 💰 실전 트레이딩 정보
- **매매 신호**: BUY / HOLD / SELL (5단계 강도)
- **진입가**: VWAP 기반 최적 진입 가격
- **익절가 3단계**: 점수 & 모멘텀 기반 자동 계산
- **손절가**: 점수별 차등 (2% ~ 5%)
- **리스크/리워드**: 자동 계산 (3:1 이상 권장)
- **포지션 사이즈**: 계좌 대비 % 추천
- **보유 기간**: Intraday / Swing / Position
- **리스크 레벨**: LOW / MEDIUM / HIGH

### 📊 분석 시스템
**기술적 (60점)**
- 거래량 폭증 (1분/5분/일 vs 20일 평균)
- VWAP 돌파
- 모멘텀 (5분/15분)
- 호가 스프레드

**뉴스 (25점)**
- MySQL DB 연동 뉴스 분석
- 상승/하락 확률, 신뢰도, 감성 점수

**펀더멘털 (15점)**
- 유동주식수, 공매도 비율

### 🔄 실시간 기능
- 동적 스캔 (SSE 스트리밍)
- 5초마다 가격 업데이트
- 상승률 실시간 계산

---

## 📖 사용 예시

### 웹 대시보드 결과

| 심볼 | 신호 | 현재가 | 진입가 | 1차 익절 | 손절가 | R/R | 포지션 | 리스크 |
|------|------|--------|--------|----------|--------|-----|--------|--------|
| VSME | 💰 BUY | $0.53 | $0.50 | $0.65 (+30%) | $0.45 (-10%) | 3:1 | 10% | MEDIUM |

**실행 계획:**
```
1. $0.50에 2,000주 매수 (계좌의 10% = $1,000)
2. $0.65 도달 시 700주 매도 (1/3)
3. $0.75 도달 시 700주 매도 (1/3)
4. $0.85 도달 시 나머지 매도
5. $0.45 이하면 즉시 손절
```

---

## 🛠️ 기술 스택

**Backend**
- Python 3.10+
- FastAPI (REST API, SSE)
- Pandas (데이터 분석)
- PyMySQL (DB 연동)
- Loguru (로깅)

**Frontend**
- HTML/JavaScript (바닐라)
- SSE (실시간 스트리밍)

**API**
- KIS Open API (급등주 리스트)
- FMP API (실시간 시세, 차트)
- MySQL (뉴스 데이터)

---

## ⚙️ 설정 (.env)

```env
# FMP API
FMP_API_KEY=your_fmp_key
FMP_BASE_URL=https://financialmodelingprep.com/stable

# KIS API
KIS_APP_KEY=your_app_key
KIS_APP_SECRET=your_app_secret
KIS_ACCOUNT_NO=your_account
KIS_MOCK_MODE=true

# MySQL
DB_HOST=your_db_host
DB_USER=your_db_user
DB_PASS=your_db_pass
DB_NAME=nasdaq
DB_PORT=3306

# Server
SERVER_HOST=0.0.0.0
SERVER_PORT=8000
```

---

## 📡 API 엔드포인트

### 스캔
```
POST   /api/scan              # 스캔 시작
GET    /api/scan/stream       # SSE 실시간 진행
GET    /api/scan/results      # 캐시된 결과
```

### 실시간 모니터
```
GET    /api/monitor/status    # 모니터 상태
GET    /api/monitor/prices    # 실시간 가격
POST   /api/monitor/add       # 종목 추가
POST   /api/monitor/remove    # 종목 제거
```

---

## 📊 트레이딩 로직

### 신호 결정
```python
if 점수 >= 70 and 모멘텀 > 5% and 거래량 > 10배:
    신호 = "BUY" (매우 강함)
elif 점수 >= 50 and VWAP 돌파:
    신호 = "BUY" (보통)
elif 점수 < 30 and 모멘텀 < -5%:
    신호 = "SELL"
else:
    신호 = "HOLD"
```

### 진입가 계산
```python
진입가 = min(현재가, VWAP * 1.01)
```

### 익절가 계산
```python
기본_목표 = {80점: 15%, 70점: 10%, 60점: 7%, 50점: 5%}
모멘텀_보너스 = min(모멘텀_5분 * 0.5, 5%)

1차_익절 = 진입가 * (1 + (기본_목표 * 0.5 + 보너스) / 100)
2차_익절 = 진입가 * (1 + (기본_목표 * 1.0 + 보너스) / 100)
3차_익절 = 진입가 * (1 + (기본_목표 * 1.5 + 보너스) / 100)
```

### 손절가 계산
```python
손절_비율 = {70점 이상: 2%, 50-70점: 3%, 50점 미만: 5%}
손절가 = max(VWAP * 0.98, 진입가 * (1 - 손절_비율 / 100))
```

---

## 🎨 웹 UI 기능

### 스캔
- 거래소 선택 (NASDAQ/NYSE/AMEX)
- 최대 종목 수 설정
- 실시간 진행 상황 표시

### 결과 테이블
- 신호 색상 코딩 (BUY=초록, HOLD=회색, SELL=빨강)
- R/R 비율 강조 (3:1+ = 초록)
- 리스크 레벨 배지 (LOW/MEDIUM/HIGH)
- 실시간 가격 & 상승률

### 실시간 모니터
- 5초 간격 가격 업데이트
- 자동 상승률 계산
- 자동 시작/중지

---

## 🔧 개발 모드

### 테스트
```bash
# 단위 테스트
pytest tests/

# 특정 테스트
pytest tests/test_scoring.py -v
```

### 로그 확인
```bash
tail -f backend/logs/*.log
```

---

## ⚠️ 면책 사항

- 이 시스템은 **참고용 정보**를 제공합니다
- 실제 매매는 **본인 책임**하에 결정하세요
- 과거 데이터 기반이므로 **미래 수익 보장 안 됨**
- **손실 가능성** 항상 존재
- 투자 전문가 상담 권장

---

## 📝 버전 히스토리

### v1.3.0 (2025-11-06) - 실전 트레이딩 시스템
- 진입가/익절가/손절가 자동 계산
- 리스크/리워드 비율 & 포지션 사이즈 추천
- 매매 신호 시스템 (BUY/SELL/HOLD)
- 웹 UI 실전 정보 중심 개편

### v1.2.0 (2025-11-06) - 동적 대시보드
- SSE 스트리밍 (실시간 진행 상황)
- FMP API URL 수정 (batch-quote)
- 백그라운드 스캔

### v1.1.0 (2025-11-06) - 실시간 모니터링
- 5초 간격 가격 업데이트
- 상승률 자동 계산
- 배치 시세 조회 최적화

### v1.0.0 (2025-11-05) - 초기 릴리즈
- 급등주 스캔 시스템
- 다중 팩터 분석 (기술적/뉴스/펀더멘털)
- 100점 스코어링
- 웹 대시보드

---

## 📧 문의

이슈 및 버그 리포트는 GitHub Issues에 등록해주세요.
